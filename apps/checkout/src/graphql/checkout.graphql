fragment CheckoutFragment on Checkout {
  id
  email
  user {
    id
    email
  }
  totalPrice {
    gross {
      amount
      currency
    }
    tax {
      currency
      amount
    }
  }
  shippingPrice {
    gross {
      amount
      currency
    }
  }
  subtotalPrice {
    gross {
      amount
      currency
    }
  }
  lines {
    ...CheckoutLineFragment
  }
}

fragment CheckoutLineFragment on CheckoutLine {
  id
  quantity
  totalPrice {
    gross {
      currency
      amount
    }
  }
  variant {
    id
    pricing {
      onSale
      price {
        gross {
          currency
          amount
        }
      }
      priceUndiscounted {
        gross {
          currency
          amount
        }
      }
    }
    name
    product {
      name
    }
    media {
      alt
      type
      url(size: 72)
    }
  }
}

query Checkout($token: UUID!) {
  checkout(token: $token) {
    ...CheckoutFragment
  }
}

mutation CheckoutLinesUpdate($token: UUID!, $lines: [CheckoutLineInput]!) {
  checkoutLinesUpdate(token: $token, lines: $lines) {
    errors {
      message
      field
      code
    }
    checkout {
      token
      lines {
        ...CheckoutLineFragment
      }
    }
  }
}

mutation CheckoutLineDelete($token: UUID!, $lineId: ID) {
  checkoutLineDelete(token: $token, lineId: $lineId) {
    errors {
      message
      field
      code
    }
    checkout {
      token
      lines {
        ...CheckoutLineFragment
      }
    }
  }
}

mutation checkoutEmailUpdate($email: String!, $token: UUID!) {
  checkoutEmailUpdate(email: $email, token: $token) {
    errors {
      field
      message
    }
    checkout {
      ...CheckoutFragment
    }
  }
}

mutation checkoutCustomerAttach($customerId: ID!, $token: UUID!) {
  checkoutCustomerAttach(customerId: $customerId, token: $token) {
    errors {
      field
      message
    }
    checkout {
      ...CheckoutFragment
    }
  }
}

mutation checkoutCustomerDetach($token: UUID!) {
  checkoutCustomerDetach(token: $token) {
    errors {
      field
      message
    }
    checkout {
      ...CheckoutFragment
    }
  }
}
